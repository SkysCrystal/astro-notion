---
import Text from './Text.astro';
import NonText from './NonText.astro'
import BlockWrapper from './BlockWrapper.astro'
import { getCorrectTagName } from '../api/utils.ts'

const textTypes = new Set(['h1', 'h2', 'h3', 'p', 'li', 'blockquote', 'pre', 'div', 'summary']);

const { blocks } = Astro.props

---

{
  blocks.map(block => {
    console.log(block)
    const blockType = block.type
    let tagName = getCorrectTagName(block, blockType);
    if (!tagName) {
      return;
    }
    return (
      block?.has_children
      ? <BlockWrapper {block} />
      : textTypes.has(tagName)
        ? <Text as={tagName} {block} />
        : <NonText as={tagName} {block} />
    )
  })
}
