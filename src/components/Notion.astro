---
import Text from './Text.astro';
import NonText from './NonText.astro'
import { getCorrectTagName } from '../lib/utils.ts'

const textTypes = new Set(['h1', 'h2', 'h3', 'p', 'li', 'blockquote', 'pre', 'div']);


const { blocks } = Astro.props

function isEmpty(obj) {
  for (const property in obj) {
    return false;
  }
  return true;
}

---

{
  blocks.map(block => {
    let tagName = getCorrectTagName(block, block.type);
    return (
      // if block has children, recursively call this component again as a slot of <Text> component
      block?.has_children ?
      <Text as={tagName} {block}>
        <Astro.self blocks={block[block.type].children} />
      </Text> :
      !textTypes.has(tagName) ?
      <NonText as={tagName} {block} /> :
      <Text as={tagName} {block} />
    )
  })
}
